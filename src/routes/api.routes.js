import { Router } from 'express'
import { stlApi } from '../controllers/api.controller'
import validateFile from '../middlewares/validateFile'

const router = Router()

/**
 * @swagger
 * tags:
 *  name: Stl Slicer
 *  description: Stl slicer endpoint api
 */

/**
 * @swagger
 * /api/stl:
 *  post:
 *      summary: Analiza y rebana los archivos stl
 *      tags: [Stl Slicer]
 *      requestBody:
 *          required: true
 *          content:
 *              multipart/form-data:
 *                  schema:
 *                      type: object
 *                      properties:
 *                          file:
 *                              type: file
 *                              description: El archivo a analizar
 *                      required:
 *                          - file
 *      responses:
 *          200:
 *              description: El archivo stl analizado y rebanado
 *              content:
 *                  application/json:
 *                      schema:
 *                          type: object
 *                          properties:
 *                              error:
 *                                  type: boolean
 *                                  description: indica si hubo un error o no
 *                                  example: false
 *                              info:
 *                                  type: object
 *                                  description: Analisis del archivo stl
 *                                  properties:
 *                                      volume:
 *                                          type: number
 *                                          description: Volumen del stl (cm^3)
 *                                          example: 0.015792687767717663
 *                                      weight:
 *                                          type: number
 *                                          description: Peso del stl (g)
 *                                          example: 0.01642439527842637
 *                                      area:
 *                                          type: number
 *                                          description: Ar√©a del stl (m)
 *                                          example: 40.75610220907029
 *                                      boundingBox:
 *                                          type: object
 *                                          description: Cuadro contenedor del stl
 *                                          properties:
 *                                              width:
 *                                                  type: number
 *                                                  description: Ancho del cuadro contenedor del stl (mm)
 *                                              height:
 *                                                  type: number
 *                                                  description: Alto del cuadro contenedor del stl (mm)
 *                                              depth:
 *                                                  type: number
 *                                                  description: Profundidad del cuadro contenedor del stl (mm)
 *                                          example:
 *                                              width: 4.5
 *                                              height: 4.5
 *                                              depth: 1.5000000000005111
 *                                      centerOfMass:
 *                                          type: object
 *                                          description: Centro de masa del stl
 *                                          properties:
 *                                              x:
 *                                                  type: number
 *                                                  description: Posicion en X del centro del masa del stl (mm)
 *                                              y:
 *                                                  type: number
 *                                                  description: Posicion en Y del centro del masa del stl (mm)
 *                                              z:
 *                                                  type: number
 *                                                  description: Posicion en Z del centro del masa del stl (mm)
 *                                          example:
 *                                              x: 37.75000750511655
 *                                              y: 46.25000751548055
 *                                              z: 0.562165832719857  
 *                              dataLength:
 *                                  type: integer
 *                                  description: La cantidad de rebanadas del stl
 *                                  example: 10
 *                              data:
 *                                  type: array
 *                                  description: Las rebanadas del stl
 *                                  items:
 *                                      type: object
 *                                      description: Rebanada del stl
 *                                      properties:
 *                                          index:
 *                                              type: integer
 *                                              description: El id de la rebanada del stl
 *                                          height:
 *                                              type: number
 *                                              description: La altura a la que se encuentra la rebanada del stl
 *                                          verts:
 *                                              type: array
 *                                              description: Los vertices de la rebanada del stl
 *                                              items:
 *                                                  type: object
 *                                                  description: Vertice de la rebanada del stl
 *                                                  properties:
 *                                                      x:
 *                                                          type: number
 *                                                          description: posicion en X del vertice de la rebanada del stl
 *                                                      y:
 *                                                          type: number
 *                                                          description: posicion en Y del vertice de la rebanada del stl
 *                                  example: [{"index":1,"height":-1.0000000000005111,"verts":[{"x":35.534000396728516,"y":46.64099884033203},{"x":35.534000396728516,"y":46.64099884033203}]},{"index":2,"height":-1,"verts":[{"x":39.19599914550781,"y":47.9739990234375},{"x":38.52000045776367,"y":44.13600158691406},{"x":38.875,"y":48.19900131225586},{"x":39.4739990234375,"y":47.69599914550781},{"x":38.52000045776367,"y":44.13600158691406},{"x":39.19599914550781,"y":47.9739990234375},{"x":38.14099884033203,"y":48.465999603271484},{"x":36.97999954223633,"y":48.36399841308594},{"x":37.75,"y":48.5},{"x":37.35900115966797,"y":48.465999603271484},{"x":37.75,"y":48.5},{"x":36.97999954223633,"y":48.36399841308594},{"x":39.965999603271484,"y":46.64099884033203},{"x":40,"y":46.25},{"x":39.86399841308594,"y":47.02000045776367},{"x":39.69900131225586,"y":47.375},{"x":39.86399841308594,"y":47.02000045776367},{"x":39.86399841308594,"y":45.47999954223633},{"x":39.965999603271484,"y":45.85900115966797},{"x":39.86399841308594,"y":45.47999954223633},{"x":39.86399841308594,"y":47.02000045776367},{"x":40,"y":46.25},{"x":39.965999603271484,"y":45.85900115966797},{"x":39.86399841308594,"y":47.02000045776367},{"x":39.86399841308594,"y":45.47999954223633},{"x":39.69900131225586,"y":45.125},{"x":39.69900131225586,"y":47.375},{"x":38.14099884033203,"y":48.465999603271484},{"x":36.0260009765625,"y":47.69599914550781},{"x":36.30400085449219,"y":47.9739990234375},{"x":36.625,"y":48.19900131225586},{"x":36.97999954223633,"y":48.36399841308594},{"x":38.14099884033203,"y":48.465999603271484},{"x":39.69900131225586,"y":45.125},{"x":39.4739990234375,"y":44.80400085449219},{"x":39.69900131225586,"y":47.375},{"x":36.625,"y":48.19900131225586},{"x":38.14099884033203,"y":48.465999603271484},{"x":36.30400085449219,"y":47.9739990234375},{"x":36.0260009765625,"y":47.69599914550781},{"x":38.14099884033203,"y":48.465999603271484},{"x":35.80099868774414,"y":47.375},{"x":35.63600158691406,"y":47.02000045776367},{"x":35.80099868774414,"y":47.375},{"x":38.14099884033203,"y":48.465999603271484},{"x":35.63600158691406,"y":47.02000045776367},{"x":38.14099884033203,"y":48.465999603271484},{"x":35.534000396728516,"y":45.85900115966797},{"x":38.14099884033203,"y":48.465999603271484},{"x":35.63600158691406,"y":45.47999954223633},{"x":35.63600158691406,"y":45.47999954223633},{"x":38.14099884033203,"y":48.465999603271484},{"x":35.80099868774414,"y":45.125},{"x":35.534000396728516,"y":45.85900115966797},{"x":35.5,"y":46.25},{"x":38.14099884033203,"y":48.465999603271484},{"x":35.5,"y":46.25},{"x":38.14099884033203,"y":48.465999603271484},{"x":38.875,"y":44.30099868774414},{"x":39.69900131225586,"y":47.375},{"x":39.19599914550781,"y":44.5260009765625},{"x":39.19599914550781,"y":44.5260009765625},{"x":39.69900131225586,"y":47.375},{"x":39.4739990234375,"y":44.80400085449219},{"x":38.52000045776367,"y":44.13600158691406},{"x":39.69900131225586,"y":47.375},{"x":38.875,"y":44.30099868774414},{"x":38.14099884033203,"y":44.034000396728516},{"x":38.52000045776367,"y":48.36399841308594},{"x":38.52000045776367,"y":44.13600158691406},{"x":39.69900131225586,"y":47.375},{"x":38.52000045776367,"y":44.13600158691406},{"x":39.4739990234375,"y":47.69599914550781},{"x":37.75,"y":44},{"x":37.35900115966797,"y":44.034000396728516},{"x":38.52000045776367,"y":48.36399841308594},{"x":37.35900115966797,"y":44.034000396728516},{"x":36.97999954223633,"y":44.13600158691406},{"x":38.52000045776367,"y":48.36399841308594},{"x":38.875,"y":48.19900131225586},{"x":38.52000045776367,"y":44.13600158691406},{"x":38.52000045776367,"y":48.36399841308594},{"x":38.14099884033203,"y":44.034000396728516},{"x":37.75,"y":44},{"x":38.52000045776367,"y":48.36399841308594},{"x":38.14099884033203,"y":48.465999603271484},{"x":38.52000045776367,"y":48.36399841308594},{"x":36.97999954223633,"y":44.13600158691406},{"x":35.80099868774414,"y":45.125},{"x":38.14099884033203,"y":48.465999603271484},{"x":36.0260009765625,"y":44.80400085449219},{"x":36.97999954223633,"y":44.13600158691406},{"x":36.625,"y":44.30099868774414},{"x":38.14099884033203,"y":48.465999603271484},{"x":36.30400085449219,"y":44.5260009765625},{"x":38.14099884033203,"y":48.465999603271484},{"x":36.625,"y":44.30099868774414},{"x":36.0260009765625,"y":44.80400085449219},{"x":38.14099884033203,"y":48.465999603271484},{"x":36.30400085449219,"y":44.5260009765625}]},{"index":3,"height":0.0646376833319664,"verts":[{"x":40.17962712049484,"y":48.401627242565155},{"x":39.901627242565155,"y":48.67962712049484},{"x":40.17962712049484,"y":48.401627242565155},{"x":35.598372757434845,"y":48.67962712049484},{"x":35.32037287950516,"y":48.401627242565155},{"x":35.598372757434845,"y":48.67962712049484},{"x":35.32037287950516,"y":44.098372757434845},{"x":39.901627242565155,"y":43.82037287950516},{"x":40.17962712049484,"y":44.098372757434845},{"x":39.901627242565155,"y":43.82037287950516},{"x":35.32037287950516,"y":44.098372757434845},{"x":35.598372757434845,"y":43.82037287950516}]},{"index":4,"height":0.06477421522140503,"verts":[{"x":40.8280770778656,"y":47.277598202228546},{"x":38.777598202228546,"y":43.1719229221344},{"x":36.722401797771454,"y":49.3280770778656},{"x":34.6719229221344,"y":45.222401797771454}]},{"index":5,"height":0.06478551775165947,"verts":[{"x":34.57038867473602,"y":46.9003349840641}]},{"index":6,"height":0.06478551775217056,"verts":[{"x":34.67238986492157,"y":47.27933660149574},{"x":40.82761013507843,"y":45.22066339850426},{"x":40.92961132526398,"y":45.5996650159359},{"x":38.4003349840641,"y":49.42961132526398},{"x":38.77933660149574,"y":49.32761013507843},{"x":37.0996650159359,"y":43.07038867473602},{"x":36.72066339850426,"y":43.17238986492157}]},{"index":7,"height":0.06488913297653198,"verts":[{"x":40.768467485904694,"y":45.05842497944832},{"x":34.731532514095306,"y":47.44157502055168},{"x":38.94157502055168,"y":49.268467485904694},{"x":36.55842497944832,"y":43.231532514095306}]},{"index":8,"height":0.06489450484514236,"verts":[{"x":38.94059854745865,"y":43.23107838630676},{"x":39.29559808969498,"y":43.39607548713684},{"x":40.76892161369324,"y":47.44059854745865},{"x":40.60392451286316,"y":47.79559808969498},{"x":36.55940145254135,"y":49.26892161369324},{"x":36.20440191030502,"y":49.10392451286316},{"x":34.73107838630676,"y":45.05940145254135},{"x":34.89607548713684,"y":44.70440191030502}]},{"index":9,"height":0.06552252173423767,"verts":[{"x":40.29147046804428,"y":48.26822918653488},{"x":35.73177081346512,"y":48.79147046804428},{"x":35.20852953195572,"y":44.23177081346512},{"x":39.76822918653488,"y":43.70852953195572}]},{"index":10,"height":0.06552290171384811,"verts":[{"x":39.44774240255356,"y":49.0161138176918},{"x":39.76874154806137,"y":48.791111528873444},{"x":35.208888471126556,"y":48.26874154806137},{"x":34.9838861823082,"y":47.94774240255356},{"x":40.291111528873444,"y":44.23125845193863},{"x":40.5161138176918,"y":44.55225759744644},{"x":36.05225759744644,"y":43.4838861823082},{"x":35.73125845193863,"y":43.708888471126556}]}]
 *          400:
 *              description: Error en el envio de datos del cliente
 *              content:
 *                  application/json:
 *                      schema:
 *                          type: object
 *                          properties:
 *                              error:
 *                                  type: boolean
 *                                  description: indica si hubo un error o no
 *                              message:
 *                                  type: string
 *                                  description: Da informacion sobre el error
 *                          example:
 *                              error: true
 *                              message: Debe enviar un archivo para analizar
 *          500:
 *              description: Error del servidor
 *              content:
 *                  application/json:
 *                      schema:
 *                          type: object
 *                          properties:
 *                              error:
 *                                  type: boolean
 *                                  description: indica si hubo un error o no
 *                              message:
 *                                  type: string
 *                                  description: Da informacion sobre el error
 *                          example:
 *                              error: true
 *                              message: Ha ocurrido un error
 */
router.post('/stl', validateFile, stlApi)

export default router